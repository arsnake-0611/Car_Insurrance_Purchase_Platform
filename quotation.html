<html>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Insurance Application</title>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Legend Motor Inc.</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
        <link rel="stylesheet" href="qutation.css">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="quotation.js"></script>
    </head>
    <body>
        <h1>Vehicle Insurance Application</h1>
        <nav id="mainNav">
            <button class="nav-button" data-section="insuranceForm">Apply</button>
            <button class="nav-button" data-section="dashboard">Dashboard</button>
        </nav>
    
        <div id="progressBar"><div></div></div>
    
        <form id="insuranceForm">
            <div id="vehicleSection" class="form-section">
                <h2>Vehicle Information</h2>
                <div class="form-group">
                    <label for="vehicleMake">Vehicle Make:</label>
                    <select id="vehicleMake" name="vehicleMake" required>
                        <option value="">Select Make</option>
                        <option value="Audi">Audi</option>
                        <option value="BMW">BMW</option>
                        <option value="Ford">Ford</option>
                        <option value="Honda">Honda</option>
                        <option value="Toyota">Toyota</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="vehicleModel">Vehicle Model:</label>
                    <select id="vehicleModel" name="vehicleModel" required>
                        <option value="">Select Model</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="vehicleYear">Manufacturing Year:</label>
                    <input type="number" id="vehicleYear" name="vehicleYear" min="1900" max="2023" required>
                </div>
                <div class="form-group">
                    <label for="bodyType">Body Type:</label>
                    <select id="bodyType" name="bodyType" required>
                        <option value="">Select Body Type</option>
                        <option value="Saloon">Saloon</option>
                        <option value="Hatchback">Hatchback</option>
                        <option value="SUV">SUV</option>
                        <option value="Coupe">Coupe</option>
                        <option value="Convertible">Convertible</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="seatingCapacity">Seating Capacity:</label>
                    <input type="number" id="seatingCapacity" name="seatingCapacity" min="2" max="9" required>
                </div>
                <div class="form-group">
                    <label for="cylinderCapacity">Cylinder Capacity (C.C.):</label>
                    <input type="number" id="cylinderCapacity" name="cylinderCapacity" min="500" max="8000" step="100" required>
                </div>
                <div class="form-group">
                    <label for="vehicleValue">Estimated Vehicle Value (HK$):</label>
                    <input type="number" id="vehicleValue" name="vehicleValue" min="0" step="1000" required>
                </div>
                <button type="button" id="nextButton">Next</button>
            </div>
    
            <div id="personalSection" class="form-section hidden">
                <h2>Personal Information</h2>
                <div class="form-group">
                    <label for="fullName">Full Name:</label>
                    <input type="text" id="fullName" name="fullName" required>
                </div>
                <div class="form-group">
                    <label for="email">Email Address:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="phoneNumber">Phone Number:</label>
                    <input type="text" id="phoneNumber" name="phoneNumber" required>
                </div>
                <div class="form-group">
                    <label for="drivingExperience">Driving Experience (years):</label>
                    <input type="number" id="drivingExperience" name="drivingExperience" min="0" max="70" required>
                </div>
                <div class="form-group">
                    <label for="coveragePlan">Select Coverage Plan:</label>
                    <select id="coveragePlan" name="coveragePlan" required>
                        <option value="">Select a plan</option>
                        <option value="comprehensive">Comprehensive Coverage</option>
                        <option value="thirdParty">Third-Party Coverage</option>
                    </select>
                </div>
                <button type="button" id="backButton">Back</button>
                <button type="submit">Submit Application</button>
            </div>
        </form>
    
        <div id="reviewSection" class="hidden">
            <h2>Review Your Application</h2>
            <div id="reviewContent"></div>
            <button id="editButton">Edit Application</button>
            <button id="confirmButton">Confirm and Submit</button>
        </div>
    
        <div id="confirmationSection" class="hidden">
            <h2>Application Submitted Successfully</h2>
            <p>Thank you for submitting your application. Your estimated processing time is 2-3 business days.</p>
            <p>Your application reference number: <strong id="applicationId"></strong></p>
            <p>You can track the status of your application using this reference number.</p>
        </div>
    
        <div id="dashboard" class="hidden">
            <h2>Dashboard</h2>
            <div id="quotationReview">
                <h3>Your Quotation</h3>
                <div id="quotationContent"></div>
                <button id="editQuotation">Edit Quotation</button>
            </div>
            <div id="websiteGuide">
                <h3>How to Use This Website</h3>
                <ol>
                    <li>Fill in the Vehicle Information form with details about your car.</li>
                    <li>Provide your Personal Information and select a Coverage Plan.</li>
                    <li>Review your application details before submitting.</li>
                    <li>After submission, you can view and edit your quotation from the Dashboard.</li>
                </ol>
            </div>
        </div>
    
        <script>
        const form = document.getElementById('insuranceForm');
        const vehicleSection = document.getElementById('vehicleSection');
        const personalSection = document.getElementById('personalSection');
        const reviewSection = document.getElementById('reviewSection');
        const confirmationSection = document.getElementById('confirmationSection');
        const reviewContent = document.getElementById('reviewContent');
        const editButton = document.getElementById('editButton');
        const confirmButton = document.getElementById('confirmButton');
        const nextButton = document.getElementById('nextButton');
        const backButton = document.getElementById('backButton');
        const progressBar = document.getElementById('progressBar').firstElementChild;
    
        const vehicleMakeSelect = document.getElementById('vehicleMake');
        const vehicleModelSelect = document.getElementById('vehicleModel');
    
        const carModels = {
            'Audi': ['A3', 'A4', 'A6', 'Q5', 'Q7'],
            'BMW': ['3 Series', '5 Series', 'X3', 'X5', 'Z4'],
            'Ford': ['Focus', 'Fiesta', 'Mustang', 'Explorer', 'F-150'],
            'Honda': ['Civic', 'Accord', 'CR-V', 'HR-V', 'Jazz'],
            'Toyota': ['Corolla', 'Camry', 'RAV4', 'Prius', 'Yaris']
        };
    
        vehicleMakeSelect.addEventListener('change', function() {
            const selectedMake = this.value;
            vehicleModelSelect.innerHTML = '<option value="">Select Model</option>';
            if (selectedMake in carModels) {
                carModels[selectedMake].forEach(model => {
                    const option = document.createElement('option');
                    option.value = model;
                    option.textContent = model;
                    vehicleModelSelect.appendChild(option);
                });
            }
        });
    
        function updateProgressBar() {
            const totalFields = form.querySelectorAll('input, select').length;
            const filledFields = Array.from(form.querySelectorAll('input, select')).filter(input => input.value !== '').length;
            const progress = (filledFields / totalFields) * 100;
            progressBar.style.width = `${progress}%`;
        }
    
        form.addEventListener('input', updateProgressBar);
    
        nextButton.addEventListener('click', function() {
            if (validateVehicleSection()) {
                vehicleSection.classList.add('hidden');
                personalSection.classList.remove('hidden');
                updateProgressBar();
            }
        });
    
        backButton.addEventListener('click', function() {
            personalSection.classList.add('hidden');
            vehicleSection.classList.remove('hidden');
        });
    
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            if (validateForm()) {
                displayReview();
                updateQuotationReview();
            }
        });
    
        function validateVehicleSection() {
            let isValid = true;
            document.querySelectorAll('#vehicleSection .error').forEach(el => el.remove());
    
            const vehicleFields = ['vehicleMake', 'vehicleModel', 'vehicleYear', 'bodyType', 'seatingCapacity', 'cylinderCapacity', 'vehicleValue'];
            vehicleFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value) {
                    showError(field, 'This field is required');
                    isValid = false;
                }
            });
    
            const vehicleYear = document.getElementById('vehicleYear');
            const currentYear = new Date().getFullYear();
            if (vehicleYear.value < 1900 || vehicleYear.value > currentYear) {
                showError(vehicleYear, `Please enter a valid year between 1900 and ${currentYear}`);
                isValid = false;
            }
    
            return isValid;
        }
    
        function validateForm() {
            let isValid = validateVehicleSection();
    
            const personalFields = ['fullName', 'email', 'phoneNumber', 'drivingExperience', 'coveragePlan'];
            personalFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value) {
                    showError(field, 'This field is required');
                    isValid = false;
                }
            });
    
            const email = document.getElementById('email');
            if (!/^\S+@\S+\.\S+$/.test(email.value)) {
                showError(email, 'Please enter a valid email address');
                isValid = false;
            }
    
            const phoneNumber = document.getElementById('phoneNumber');
            if (!/^\d+$/.test(phoneNumber.value)) {
                showError(phoneNumber, 'Please enter a valid phone number (numbers only)');
                isValid = false;
            }
    
            const coveragePlan = document.getElementById('coveragePlan');
            if (coveragePlan.value === "") {
                showError(coveragePlan, 'Please select a coverage plan');
                isValid = false;
            }
    
            return isValid;
        }
    
        function showError(input, message) {
            const error = document.createElement('div');
            error.className = 'error';
            error.innerText = message;
            input.parentNode.insertBefore(error, input.nextSibling);
        }
    
        function displayReview() {
            const formData = new FormData(form);
            let reviewHTML = '<h3>Please review your information:</h3>';
            for (let [key, value] of formData.entries()) {
                reviewHTML += `<p><strong>${formatLabel(key)}:</strong> ${value}</p>`;
            }
            reviewContent.innerHTML = reviewHTML;
            form.classList.add('hidden');
            reviewSection.classList.remove('hidden');
        }
    
        function formatLabel(key) {
            return key.replace(/([A-Z])/g, ' $1')
                .replace(/^./, function(str){ return str.toUpperCase(); })
                .replace(/([A-Z])/g, function(str, p1) { return ' ' + p1.toLowerCase(); });
        }
    
        editButton.addEventListener('click', function() {
            reviewSection.classList.add('hidden');
            form.classList.remove('hidden');
            vehicleSection.classList.remove('hidden');
            personalSection.classList.add('hidden');
        });
    
        confirmButton.addEventListener('click', function() {
            reviewSection.classList.add('hidden');
            confirmationSection.classList.remove('hidden');
            const applicationId = 'INS' + Math.random().toString(36).substr(2, 9).toUpperCase();
            document.getElementById('applicationId').textContent = applicationId;
            updateQuotationReview();
        });
    
        function showSection(sectionId) {
            const sections = ['insuranceForm', 'reviewSection', 'confirmationSection', 'dashboard'];
            sections.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(sectionId).classList.remove('hidden');
            
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.nav-button[data-section="${sectionId}"]`).classList.add('active');
        }
    
        function updateQuotationReview() {
            const formData = new FormData(form);
            let reviewHTML = '';
            for (let [key, value] of formData.entries()) {
                reviewHTML += `<p><strong>${formatLabel(key)}:</strong> ${value}</p>`;
            }
            document.getElementById('quotationContent').innerHTML = reviewHTML;
        }
    
        document.querySelectorAll('.nav-button').forEach(button => {
            button.addEventListener('click', function() {
                showSection(this.dataset.section);
            });
        });
    
        document.getElementById('editQuotation').addEventListener('click', function() {
            showSection('insuranceForm');
        });
    
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            if (validateForm()) {
                displayReview();
                updateQuotationReview();
            }
        });
    
        confirmButton.addEventListener('click', function() {
            reviewSection.classList.add('hidden');
            confirmationSection.classList.remove('hidden');
            const applicationId = 'LM' + Math.random().toString(36).substr(2, 9).toUpperCase();
            document.getElementById('applicationId').textContent = applicationId;
            updateQuotationReview();
        });
    
        showSection('insuranceForm');
        </script>
    </body>
    </html>